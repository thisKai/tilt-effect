{"version":3,"file":"tilt-effect.js","sources":["../../src/rotation.js","../../src/transform.js","../../src/hit.js","../../src/effect.js","../../src/main-umd.js"],"sourcesContent":["export default function tiltRotation(\n  bounds,\n  mouseX,\n  mouseY,\n  tiltAmount,\n) {\n  // find the distance from the center of the element to the pointer\n  const {\n    top,\n    left,\n    width,\n    height,\n  } = bounds\n\n  // center of element\n  const centerX = left + (width / 2)\n  const centerY = top + (height / 2)\n\n\n  // distance from pointer to center of element\n  const x = (centerX - mouseX) / -width / (16 / tiltAmount)\n  const y = (centerY - mouseY) / height / (16 / tiltAmount)\n\n  return { x, y }\n}\n","import tiltRotation from './rotation'\n\nexport default function tiltTransform(\n  bounds,\n  mouseX,\n  mouseY,\n  tiltAmount,\n  sinkAmount,\n) {\n  const { x, y } = tiltRotation(\n    bounds,\n    mouseX,\n    mouseY,\n    tiltAmount,\n  )\n  const { width, height } = bounds\n\n  const perspective = 400\n  const translateZ = -10 * sinkAmount\n\n  const extraTransform = ''\n\n  return `perspective(${perspective}px) translateZ(${translateZ}px) rotateY(${x}turn) rotateX(${y}turn) ${extraTransform}`\n}\n","export default function hitTest(\n  bounds,\n  mouseX,\n  mouseY,\n) {\n  const {\n    top,\n    left,\n    bottom,\n    right,\n  } = bounds\n\n  // check if pointer is between the left and right edges\n  const x = mouseX >= left && mouseX <= right\n  // check if pointer is between the top and bottom edges\n  const y = mouseY >= top && mouseY <= bottom\n\n  return x && y\n}\n","import tiltTransform from './transform'\nimport hitTest from './hit'\n\n/**\n * tilt an element when it is pressed\n *\n * @param {Object} options\n * @param {HTMLElement} options.tiltElement - the element that will be transformed\n * @param {HTMLElement} options.hitElement - the element that listens to pointer events, by default it is the same as the tiltElement\n * @param {boolean} options.draggable\n * @param {number} options.tiltAmount\n * @param {number} options.sinkAmount\n *\n * @return {TiltEffectInstance} a tilt effect instance\n */\nexport default function TiltEffect({\n  tiltElement,\n  hitElement = tiltElement,\n  draggable = false,\n  tiltAmount = 1,\n  sinkAmount = 1,\n}) {\n  let _isTilting = false\n\n  const state = {\n    get isTilting() { return _isTilting },\n    set isTilting(val) {\n      _isTilting = val\n      tiltElement.classList.toggle('tilted', val)\n      if (val) {\n        hitElement.style.transform = 'none'\n        state.bounds = hitElement.getBoundingClientRect()\n      } else {\n        tiltElement.style.transform = 'none'\n      }\n    },\n    isPointerDown: false,\n    bounds: null,\n  }\n  const onPointerMove = e => {\n    const { clientX, clientY } = e\n\n    if (hitTest(state.bounds, clientX, clientY)) {\n      state.isTilting = true\n    } else {\n      state.isTilting = false\n    }\n    if (state.isTilting) {\n      tiltElement.style.transform = tiltTransform(state.bounds, clientX, clientY, tiltAmount, sinkAmount)\n    }\n  }\n\n  const onPointerUp = e => {\n    state.isTilting = false\n    state.isPointerDown = false\n    window.removeEventListener('pointermove', onPointerMove)\n    window.removeEventListener('pointerup', onPointerUp)\n    window.removeEventListener('dragend', onPointerUp)\n  }\n  const onPointerDown = e => {\n    state.isTilting = true\n    state.isPointerDown = true\n\n    const { clientX, clientY } = e\n    setTimeout(() => {\n      tiltElement.style.transform = tiltTransform(state.bounds, clientX, clientY, tiltAmount, sinkAmount)\n    }, 0)\n\n    window.addEventListener('pointermove', onPointerMove)\n    window.addEventListener('pointerup', onPointerUp)\n    window.addEventListener('dragend', onPointerUp)\n  }\n\n  hitElement.addEventListener('pointerdown', onPointerDown)\n\n  return {\n    destroy() {\n      window.removeEventListener('pointermove', onPointerMove)\n      window.removeEventListener('pointerup', onPointerUp)\n      window.removeEventListener('dragend', onPointerUp)\n      hitElement.removeEventListener('pointerdown', onPointerDown)\n    },\n\n    get tiltElement() { return tiltElement },\n    set tiltElement(value) { tiltElement = value },\n\n    get hitElement() { return hitElement },\n    set hitElement(value) { hitElement = value },\n\n    get draggable() { return draggable },\n    set draggable(value) { drag = value },\n\n    get tiltAmount() { return tiltAmount },\n    set tiltAmount(value) { tiltAmount = value },\n\n    get sinkAmount() { return sinkAmount },\n    set sinkAmount(value) { sinkAmount = value },\n  }\n}\n\n/**\n * @typedef {Object} TiltEffectInstance\n * @property {function()} destroy remove all event handlers created by this instance\n * @property {HTMLElement} tiltElement\n * @property {HTMLElement} hitElement\n * @property {boolean} draggable\n * @property {number} tiltAmount\n * @property {number} sinkAmount\n */\n","import tiltTransform from './transform'\nimport hitTest from './hit'\nimport TiltEffect from './effect'\n\nTiltEffect.hitTest = hitTest\nTiltEffect.tiltTransform = tiltTransform\n\nexport default TiltEffect\n"],"names":["tiltRotation","bounds","mouseX","mouseY","tiltAmount","top","left","width","height","centerX","centerY","x","y","tiltTransform","sinkAmount","perspective","translateZ","extraTransform","hitTest","bottom","right","TiltEffect","tiltElement","hitElement","draggable","_isTilting","state","isTilting","val","classList","toggle","style","transform","getBoundingClientRect","onPointerMove","clientX","e","clientY","onPointerUp","isPointerDown","removeEventListener","onPointerDown","addEventListener","value"],"mappings":"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"}